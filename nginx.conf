# server {
#     listen 80;
#     server_name localhost;
    
#      # Allow underscore headers
#     underscores_in_headers on;
#     ignore_invalid_headers off; 
    
#     root /usr/share/nginx/html;

#     index index.html;

#     # Handle all routes by serving the index.html file
#     location / {
#         try_files $uri /index.html;
#     }

server {
    listen 80;
    server_name asklepios.nereuscloud.de;
    return 301 https://$host$request_uri;
}

# 2) HTTPS server for your React SPA
server {
    listen 443 ssl http2;
    server_name asklepios.nereuscloud.de;

    # --- TLS certs (Let's Encrypt example) ---
    ssl_certificate     /etc/letsencrypt/live/asklepios.nereuscloud.de/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/asklepios.nereuscloud.de/privkey.pem;

    # (recommended hardening)
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

    # --- Serve the built app ---
    root /usr/share/nginx/html;   # where your React build (index.html, static/) lives
    index index.html;

    # SPA routing (works for HashRouter and BrowserRouter)
    location / {
        try_files $uri /index.html;
    }

    # Optional: gzip static assets
    gzip on;
    gzip_types text/css application/javascript application/json image/svg+xml;

    error_page 404 /index.html;
}
